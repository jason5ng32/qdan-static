(function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if("object"==typeof a){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if("object"===c)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:this.EventEmitter=a}).call(this),function(a){function b(b){var c=a.event;return c.target=c.target||c.srcElement||b,c}var c=document.documentElement,d=function(){};c.addEventListener?d=function(a,b,c){a.addEventListener(b,c,!1)}:c.attachEvent&&(d=function(a,c,d){a[c+d]=d.handleEvent?function(){var c=b(a);d.handleEvent.call(d,c)}:function(){var c=b(a);d.call(a,c)},a.attachEvent("on"+c,a[c+d])});var e=function(){};c.removeEventListener?e=function(a,b,c){a.removeEventListener(b,c,!1)}:c.detachEvent&&(e=function(a,b,c){a.detachEvent("on"+b,a[b+c]);try{delete a[b+c]}catch(d){a[b+c]=void 0}});var f={bind:d,unbind:e};"function"==typeof define&&define.amd?define("eventie/eventie",f):a.eventie=f}(this),function(a,b){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(c,d){return b(a,c,d)}):"object"==typeof exports?module.exports=b(a,require("wolfy87-eventemitter"),require("eventie")):a.imagesLoaded=b(a,a.EventEmitter,a.eventie)}(window,function(a,b,c){function d(a,b){for(var c in b)a[c]=b[c];return a}function e(a){return"[object Array]"===m.call(a)}function f(a){var b=[];if(e(a))b=a;else if("number"==typeof a.length)for(var c=0,d=a.length;d>c;c++)b.push(a[c]);else b.push(a);return b}function g(a,b,c){if(!(this instanceof g))return new g(a,b);"string"==typeof a&&(a=document.querySelectorAll(a)),this.elements=f(a),this.options=d({},this.options),"function"==typeof b?c=b:d(this.options,b),c&&this.on("always",c),this.getImages(),j&&(this.jqDeferred=new j.Deferred);var e=this;setTimeout(function(){e.check()})}function h(a){this.img=a}function i(a){this.src=a,n[a]=this}var j=a.jQuery,k=a.console,l="undefined"!=typeof k,m=Object.prototype.toString;g.prototype=new b,g.prototype.options={},g.prototype.getImages=function(){this.images=[];for(var a=0,b=this.elements.length;b>a;a++){var c=this.elements[a];"IMG"===c.nodeName&&this.addImage(c);var d=c.nodeType;if(d&&(1===d||9===d||11===d))for(var e=c.querySelectorAll("img"),f=0,g=e.length;g>f;f++){var h=e[f];this.addImage(h)}}},g.prototype.addImage=function(a){var b=new h(a);this.images.push(b)},g.prototype.check=function(){function a(a,e){return b.options.debug&&l&&k.log("confirm",a,e),b.progress(a),c++,c===d&&b.complete(),!0}var b=this,c=0,d=this.images.length;if(this.hasAnyBroken=!1,!d)return void this.complete();for(var e=0;d>e;e++){var f=this.images[e];f.on("confirm",a),f.check()}},g.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;var b=this;setTimeout(function(){b.emit("progress",b,a),b.jqDeferred&&b.jqDeferred.notify&&b.jqDeferred.notify(b,a)})},g.prototype.complete=function(){var a=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var b=this;setTimeout(function(){if(b.emit(a,b),b.emit("always",b),b.jqDeferred){var c=b.hasAnyBroken?"reject":"resolve";b.jqDeferred[c](b)}})},j&&(j.fn.imagesLoaded=function(a,b){var c=new g(this,a,b);return c.jqDeferred.promise(j(this))}),h.prototype=new b,h.prototype.check=function(){var a=n[this.img.src]||new i(this.img.src);if(a.isConfirmed)return void this.confirm(a.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var b=this;a.on("confirm",function(a,c){return b.confirm(a.isLoaded,c),!0}),a.check()},h.prototype.confirm=function(a,b){this.isLoaded=a,this.emit("confirm",this,b)};var n={};return i.prototype=new b,i.prototype.check=function(){if(!this.isChecked){var a=new Image;c.bind(a,"load",this),c.bind(a,"error",this),a.src=this.src,this.isChecked=!0}},i.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)},i.prototype.onload=function(a){this.confirm(!0,"onload"),this.unbindProxyEvents(a)},i.prototype.onerror=function(a){this.confirm(!1,"onerror"),this.unbindProxyEvents(a)},i.prototype.confirm=function(a,b){this.isConfirmed=!0,this.isLoaded=a,this.emit("confirm",this,b)},i.prototype.unbindProxyEvents=function(a){c.unbind(a.target,"load",this),c.unbind(a.target,"error",this)},g}),$(function(){function a(a,b,c){var d=window.location.protocol+"//"+window.location.host;d+="/list/"+a,d+="?utm_source=share&utm_medium=web&utm_term="+b+"&utm_campaign=qdan",$.ajax({url:"https://s.qdan.me/_",dataType:"jsonp",data:{url:d}}).done(function(a){c(a.url)}).fail(function(){c()})}window.share=window.share||{},window.share.mail=function(b,c,d){c="看看这个轻单【"+c+"】吧！",d=d?d+"\n":c+"\n",a(b,"email",function(a){location.href="mailto:?subject="+c+"&body="+d+"  "+a})},window.share.weibo=function(b,c,d,e){var f=window.open(),g={url:location.href,type:"2",count:"",appkey:"",title:document.title,pic:"",ralateUid:"",source:"轻单",sourceUrl:"https://qdan.me",content:"utf8",searchPic:"",language:"zh_cn"};c=d?"【"+c+"】"+d:c,a(b,"weibo",function(a){var b=$.extend(g,{url:a,title:"#轻单# "+c,pic:e}),d=[];for(var h in b)b.hasOwnProperty(h)&&b[h]&&d.push(h+"="+encodeURIComponent(b[h]||""));f.location.href="http://service.weibo.com/share/share.php?"+d.join("&")})},window.share.weixin={_$el:$(".modal-share"),_isInited:!1,init:function(a){var b=this,c=b._$el,d=c.find("p.img img");return d.attr("src","/qrcode/"+encodeURIComponent(a)),this._isInited===!1&&(this._isInited=!0,function(){var a=function(a){return a.preventDefault(),b.close(),!1};$("body").on("keydown",function(b){27===b.which&&a(b)}),b._$el.on("click","em",a)}()),this},open:function(b){var c=this;a(b,"weixin",function(a){c.init(a)._$el.show().children().hide().filter(".share-container-cover").fadeIn("fast",function(){c._$el.find(".share-container").show().css({opacity:"0",marginTop:"+=0px"}).animate({opacity:"1",marginTop:"-=80px"},"fast",function(){c._$el.children()})})})},close:function(){var a=this;a._$el.children().filter(".share-container").animate({opacity:"0",marginTop:"-=80px"},"fast",function(){a._$el.find(".share-container-cover").fadeOut("fast",function(){a._$el.hide().removeAttr("style").children().removeAttr("style")})})}},window.share.twitter=function(b,c){var d=window.open();c="【"+c+"】",a(b,"twitter",function(a){d.location.href="https://twitter.com/intent/tweet?text="+c+"&url="+encodeURIComponent(a)+"&source=webclient&related=qdan.me&via=qdanme&hashtags=轻单"})},window.share.copy=function(b){a(b,"copy",function(a){window.hasOwnProperty("clipboardData")?(window.clipboardData.setData("Text",a),qlist.toast("复制成功:\n\n "+a)):prompt("你的浏览器不支持直接复制，请手动复制",a)})}}),$(function(){var a=$("body"),b='<div class="modal modal-img"><div class="img-container-cover"></div><div class="img-container"><div class="loading"></div></div></div>';window.imgModal={_clickClose:!0,_scrollClose:!0,_originScrollTop:0,_bigimg:null,_duration:screen.width<600?0:"fast",_closing:!1,init:function(){var a=this;return $(window).bind("scroll",function(b){return a._$el.is(":visible")?(b.preventDefault(),void(a._scrollClose&&!a._closing&&Math.abs(a._originScrollTop-$(window).scrollTop())>20&&a.close())):!0}),$(".modal-img").bind("mousewheel",function(){return a._scrollClose?void 0:!1}),function(){var b=function(b){return a._clickClose?(b.preventDefault(),a.close(),!1):!0};$("body").on("keydown",function(a){27===a.which&&b(a)}),$(".modal-img").on("click",b)}(),this},open:function(c,d,e,f){if(/MicroMessenger/i.test(navigator.userAgent))return!1;var g=this;0===$(".modal-img").length&&(a.append(b),this.init()),this._$el=$(".modal-img"),this._clickClose=_.isBoolean(e)?e:!0,this._scrollClose=_.isBoolean(f)?f:!0,this._originScrollTop=$(window).scrollTop(),c.indexOf("<")>-1?($(".img-container").html(c),$(".modal-img").removeClass("cursor-zoomout")):(this._bigimg&&$(this._bigimg).remove(),this._bigimg=new Image,$(".img-container").append(this._bigimg),$(".modal-img").addClass("cursor-zoomout"),this._$el.find(".loading").show(),this._bigimg.src=c,this._bigimg.complete?g._$el.find(".loading").hide():this._bigimg.onload=function(){g._bigimg.onload=null,g._$el.find(".loading").hide()}),g._$el.show().children().hide().filter(".img-container-cover").css("background","rgba(255,255,255,"+d+")").fadeIn(g._duration,function(){g._$el.find(".img-container").show().css({opacity:"0"}).animate({opacity:"1"},g._duration,function(){g._$el.children()})})},close:function(){var a=this;_.isUndefined(a._$el)||(a._closing=!0,a._$el.children().filter(".img-container").animate({opacity:"0"},a._duration,function(){a._$el.find(".img-container-cover").fadeOut(a._duration,function(){a._$el.hide().removeAttr("style").children().removeAttr("style"),a._closing=!1})}))}}}),window.zoomIn=function(a,b,c,d){window.imgModal.open(a,b,c,d)},$(function(){function a(a){var b=a.siblings("embed");a.hide(),b.show()}function b(a){var b=a.closest(".slt-video"),c=$("<embed></embed>").attr({src:b.data("vsrc"),flashvars:b.data("flashvars"),allowFullScreen:!0,quality:"high",align:"middle",allowScriptAccess:"always",type:"application/x-shockwave-flash"});c.insertAfter(b.find(".sl-desc")),b.addClass("play")}function c(c){var d=$(this);if(d.hasClass("footer-text")&&(d=d.closest("._smartlink-base").find(".sl-title-wrapper>a")),d.hasClass("sl-cover-wrapper")&&!d.hasClass("nozi")){var e="";d.find("img").length?(e=d.find("img:first").data("big"),e||(e=d.find("img:first").attr("src"))):(e=d.data("big"),e||(e=d.css("background-image"),e=e.substring("url(".length,e.length-1))),window.sidebar&&_.startsWith(e,'"')&&(e=e.substring(1,e.length-1)),zoomIn(e,null,!0,!0)}else if(d.attr("href")){var f=d.attr("href");f+=f.indexOf("?")>1?"&":"?",f+="utm_source=qdan.me#/";var g=_.startsWith(location.protocol,"https"),h=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);!d.hasClass("video")&&!d.hasClass("audio")||g||h?window.open(f,"_blank"):d.hasClass("video")?b(d):a(d),c.preventDefault()}}$("body").on("click",".sl-video-collapse",function(){var a=$(this);a.closest(".slt-video").removeClass("play").find("embed").detach()}).on("click","._smartlink-base .sl-title, ._smartlink-base .btn-open, ._smartlink-base .footer-text",c),$(".sl-cover-wrapper").on("click",c)}()),$(function(){function a(a){a=$.trim(a),/^((https?|ftp|news):\/\/)/i.test(a)||(a="http://"+a);var b=document.createElement("a");return b.href=a,{source:a,protocol:b.protocol,host:b.host,hostname:b.hostname,port:b.port,relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[""])[1]}}var b=$(window),c=$(document.body);c.on("click",".action-bar a.share-bt",function(){var a=$(this),b=a.closest(".container"),c=a.attr("class"),d=b.attr("id").slice(5),e=b.find(".detail h1").text(),f="";switch(b.find("img").each(function(){a.data("large")&&(f+="||"+a.data("large"))}),f=f.slice(2),c){case"share-bt share-weibo-bt":var g=$(this).data("note");window.share.weibo(d,e,g,f);break;case"share-bt share-twitter-bt":window.share.twitter(d,e);break;case"share-bt share-weixin-bt":window.share.weixin.open(d)}return!1}),$(".side-mod.action").on("click",".unstar",function(){var a=$(this),b=a.data("id"),c=$("span.stars"),d=parseInt(c.text(),10);c.text(d-1),a.parent().removeClass("stared"),services.unfavorList({data:{listId:b}}).done(function(){qlist.toast(["已取消收藏"])}).fail(function(){c.text(d),a.parent().addClass("stared"),qlist.toast("没有取消收藏成功，请重试~")})}).on("click",".star",function(){var a=$(this),b=a.data("id"),c=$("span.stars"),d=parseInt(c.text(),10);c.text(d+1),a.parent().addClass("stared"),services.favorList({data:{listId:b}}).done(function(){qlist.toast(["收藏成功！"])}).fail(function(){c.text(d),a.parent().removeClass("stared"),qlist.toast("没有收藏成功，请重试…")})}),$("p.link a").each(function(){var b=$(this),c=$.trim(b.text()),d=a(b.attr("href"));if(!d.hostname)return void b.removeAttr("href");var e=d.source;if(e+=e.indexOf("?")>1?"&":"?",e+="utm_source=qdan.me#/",b.attr("href",e),!c){var f=d.protocol+"//",g=d.host;g.match(/^www./i)&&(f+="www.",g=g.slice(4));var h=20-d.host.length,i=d.relative;h>0&&"/"!==i&&(g+=d.relative.slice(0,h),i=d.relative.slice(h));var j='<span class="invisible">'+f+"</span>";j+='<span class="visible">'+g+"</span>","/"!==i&&(j+='<span class="invisible">'+i+"</span>"),i&&g.length+i.length>20&&(j+='<span class="ellipsis"></span>'),b.html(j)}"qdan.me"!==d.host&&b.append('<i class="qlisticon icon-Open-new-tab"></i>')});var d=navigator.userAgent;/MicroMessenger/i.test(d)||c.on("click",".note>figure img, .cover>.embed-container img",function(a){a.preventDefault();var b=$(this).data("large");return window.imgModal.open(b,null,!0,!0),!1}),_.defer(function(){var a=$(".container .detail > .note"),b=a.get(0),c=b?b.scrollHeight>b.offsetHeight:!1,d=$("<a></a>").html("… 更多").attr({"class":"expand skin-cl",href:"#"}).click(function(a){return a.preventDefault(),!1});c?d.insertAfter(a).add(a).click(function(){a.removeClass("not-expanded"),d.remove()}):a.removeClass("not-expanded")}),function(){var a=$(".topic-info-container"),b=a.find(".topic-edit-button"),c=$(".topic-editor-container"),d=$(".topic-section"),e=c.find("form"),f=$(".topic-search"),g=c.find(".topic-maxcount"),h=$("#topicInfoTemplate"),i=$("#topicEditorTemplate"),j=$("#topicSearchTemplate"),k=c.data("id"),l=_.template(h.html()),m=_.template(i.html()),n=_.template(j.html()),o=function(){var a=$(".topic-text"),b=$.trim(a.val());return 0===b.length?void f.empty().hide():void services.searchTopic({keyword:b}).done(function(a){a&&!a.code?(f.empty().show(),a.forEach(function(a){$(n({topic:a})).appendTo(f)})):f.empty().hide()}).fail(function(){f.empty().hide()})},p=function(a){var b=$(this),c=b.find(".topic-text"),d=f.find(".active").text()||$.trim(c.val()),e=b.find(".submit"),g=e.val(),h=$.Deferred();return a.preventDefault(),b.hasClass("disabled")?(h.reject(),h):d?(b.addClass("disabled"),e.val("请稍候"),services.addTopic({listId:k,topic:d}).done(function(a){c.val(""),f.empty().hide(),h.resolve(a)}).fail(function(a){var b=a.responseJSON?a.responseJSON:{};switch(b.code){case 1602:qlist.toast("此话题已存在");break;default:qlist.toast("添加话题失败，请重试！")}h.reject()}).always(function(){b.removeClass("disabled"),e.val(g)}),h):(qlist.toast("不能添加空话题"),c.focus(),h.reject(),h)};a.on("click",".topic-edit-button",function(){a.hide(),c.show()}),f.on("mouseover",".tp-row",function(){$(this).addClass("active").siblings(".active").removeClass("active")}).on("click",".tp-row",function(){$(this).closest("form").submit()}),c.on("click","a.close",function(){c.hide(),a.show()}).on("click","a.del-topic",function(){var a=$(this),b=a.closest("span"),c=b.data("id");b.fadeIn("fast"),services.delTopic({listId:k,topicid:c}).done(function(a){b.fadeIn("fast",function(){b.remove()}),$("#topic-"+c).remove(),a.length<5&&(e.addClass("active"),g.hide())}).fail(function(){b.fadeOut("fast"),qlist.toast("移除失败，请重试")})}).on("submit",".add-topic",function(a){var c=this,e=$(c);p.call(this,a).done(function(a){a.length>4&&(e.removeClass("active"),g.show());var c=a.pop();$(m({topic:c})).appendTo(d),$(l({topic:c})).insertBefore(b)})}).on("keyup",".topic-text",function(a){var b=$(this),c=f.children(".active");switch(a.keyCode){case 13:b.closest("form").submit();break;case 27:f.empty().hide();break;case 38:c=c.prev().length?c.prev():f.children(":last"),c.addClass("active").siblings().removeClass("active");break;case 40:c=c.next().length?c.next():f.children(":first"),c.addClass("active").siblings().removeClass("active");break;default:o()}})}(),function(){var a=$(".comment-container"),c=a.find(".title > .count"),d=$(".comments"),e=$(".add-comment"),f=e.data("id"),g=$("#commentTemplate"),h=$("#replyTemplate"),i=$("#commentRelpyFormTemplate"),j=_.template(g.html()),k=_.template(h.html()),l=_.template(i.html()),m=function(a){var b=$(this),d=b.find(".note"),e=d.val(),g=b.find(".replyid").val(),h=b.find(".submit"),i=h.val(),j=$.Deferred();return a.preventDefault(),b.hasClass("disabled")?(j.reject(),j):e?(b.addClass("disabled"),h.val("请稍候"),services.addComment({listId:f,note:e,replyid:g}).done(function(a){c.html(parseInt(c.html(),10)+1),d.val(""),j.resolve(a)}).fail(function(){qlist.toast("评论发表失败，请重试"),j.reject()}).always(function(){b.removeClass("disabled"),h.val(i)}),j):(qlist.toast("评论不能为空"),d.focus(),j.reject(),j)},n=$.cookie("likeCommentLog")||"";n=n?n.split(","):[],g.add(h).add(i).remove(),a.on("click",".add-reply-link",function(){var a=$(this).parents(".comment"),b=a.find(".replies"),c=b.find("form");c.length?c.show():c=$(l({replyid:a.data("id")})).appendTo(b),c.find(".note").focus()}).on("click",".cancel-reply",function(){var a=$(this).parents(".add-reply-comment");a.find(".note").val(""),a.removeClass("active")}).on("click",".del-comment",function(){var b=$(this),d=b.parents(".comment").first(),e=d.find(".reply").length?"下面的回复也将被删除，确定继续吗？":"确定要删除吗？";return confirm(e)?(d.slideUp("fast"),void services.delComment({commentId:d.data("id")}).done(function(){d.slideUp("fast",function(){d.remove(),c.html(a.find(".comment").length)})}).fail(function(){d.slideDown("fast"),qlist.toast("移除失败，请重试")})):!1}).on("focus",".add-reply-comment .note",function(){$(this).parents("form").first().addClass("active")}).on("blur",".add-reply-comment .note",function(){var a=$(this).parents("form");_.delay(function(){var b=a.find(".note").val();a.hasClass("disabled")||b||a.removeClass("active"),b||a.find(".note").removeAttr("style")},100)}).on("keydown, focus, click",".note",function(){return _.isEmpty(qlist.userInfo)?($(this).blur(),$(".modal-login").trigger("open"),!1):void 0}).on("submit",".add-reply-comment",function(a){var b=this,c=$(b);return _.isEmpty(qlist.userInfo)?($(".modal-login").trigger("open"),!1):void m.call(this,a).done(function(a){$(k({comment:a})).insertBefore(c).hide().fadeIn(0)})}).on("submit",".add-comment",function(a){m.call(this,a).done(function(a){$(j({comment:a})).appendTo(d).hide().fadeIn(0)})}).on("keydown",".note",function(a){var b=$(this);(a.metaKey||a.ctrlKey)&&13===a.which&&b.parents("form").submit()}).on("keydown input",".note",function(){var c=a.find(".comment-textarea").last(),d=c.clone().removeAttr("id").css({height:"1px",position:"absolute",overflow:"hidden",top:"-9999px",left:"-9999px"}).appendTo(a),e=function(){d.css({width:c.outerWidth(),paddingTop:c.css("paddingTop"),paddingRight:c.css("paddingRight"),paddingBottom:c.css("paddingBottom"),paddingLeft:c.css("paddingLeft"),fontSize:c.css("fontSize"),fontFamily:c.css("fontFamily"),lineHeight:c.css("lineHeight")})};return e(),b.on("resize",_.debounce(e,100)),_.throttle(function(a){_.defer(function(){c=$(a.target),d.val(c.val()),c.css({height:d.get(0).scrollHeight+20})})},100)}()).on("click",".like-comment",function(){var a=$(this),b=a.parents(".comment").first(),c=b.data("id"),d=b.find(".likes").first(),e=parseInt(d.html(),10);return a.hasClass("clicked")?!1:(a.removeClass("icon-favorite-outline").addClass("clicked icon-favorite"),d.html(e+1),void services.likeComment({commentId:c}).done(function(){var a=$.cookie("likeCommentLog")||"";a=a?a.split(","):[],a.push(c),a=a.join(","),$.cookie("likeCommentLog",a,{path:"/",expires:9999,domain:"."+location.hostname})}).fail(function(){d.html(e-1),a.addClass("icon-favorite-outline").removeClass("clicked icon-favorite"),qlist.toast("出现错误，请重试")}))}).on("click",".report-comment",function(){var a=$(this),b=a.html(),c=a.parents(".comment").first(),d=c.data("id");return a.hasClass("clicked")?!1:(a.addClass("clicked").html("请稍候"),void services.reportComment({commentId:d}).done(function(){qlist.toast("感谢你的举报，我们将尽快处理"),a.addClass("clicked").html("已举报")}).fail(function(){a.removeClass("clicked").html(b)}))}),a.find(".like-comment").each(function(a,b){var c=$(b),d=c.parents(".comment").first(),e=d.data("id");_.contains(n,e)&&c.removeClass("icon-favorite-outline").addClass("clicked icon-favorite")}),a.length&&$(document).scroll(function(){var c=window.pageYOffset||document.documentElement.scrollTop,d=a.offset().top;d-c>b.height()/2?$(".ui-add").removeClass("hidden"):$(".ui-add").addClass("hidden")}).scroll(),location.hash&&$(location.hash).length&&$("html, body").animate({scrollTop:$(location.hash).offset().top-$("#sectionHeader").height()},500)}()});